/**
 * adventure = {
 *
 *   // (array of strings) tags for this adventure. can be used to get specific encounter types
 *   tags: [],
 *
 *   // (array of effects) executed when adventure is complete
 *   completed: [
 *     {effect object},
 *     {effect object}
 *   ],
 *
 *   // (array of encounters)
 *   encounters: [
 *     { encounter object },
 *     { encounter object },
 *     ....
 *   ],
 * }
 */

var _ = require('lodash');
var tools = require('tools');

/**
 * An adventure is a grouped list of encounters.
 */
var Adventure = function( stub ){
  // (bool) is adventure from a stub?
  this.is_stub = false;

  // (bool) adventure stub's filename
  this.filename = false;

  // (bool) - index if pulled from stubs array
  this.index = false;

  // adventure title
  this.title = '';

  // adventure description
  this.desc = '';

  // (array of strings) tags for this adventure. can be used to get specific encounter types
  this.tags = [];

  // (array of effects) executed when adventure is complete
  this.success = [];

  // (array of encounters)
  this.encounters = [];


  // merge stub into object
  if ( typeof stub === 'object' ) {
    console.log('-- adventure constructor with stub');
    _.merge(this, stub);
  }

  // if the stub has not been reloaded from file yet, do so
  if ( this.is_stub && this.filename ){
    console.log('-- adventure reloaded from file');
    // reload if adventure is a stub and not already loaded
    var adventureStub = tools.files.getAdventure( this.filename, this.index );

    // TODO: temporary, see encounter
    // allow partial stub values to overwrite file stub values
    _.merge(adventureStub, stub );

    // remerge the stub to this adventure
    _.merge( this, adventureStub);
  }
};

module.exports = Adventure;